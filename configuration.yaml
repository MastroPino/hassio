homeassistant:
  name: Casa
  latitude: !secret home_latitude
  longitude: !secret home_longitude
  elevation: !secret home_elevation
  unit_system: metric
  time_zone: Europe/Rome

  customize: !include customize.yaml
  packages: !include_dir_named packages

# Enables the frontend
frontend:
  javascript_version: es5
  themes: !include_dir_merge_named themes/

panel_iframe:
  sonoff_garage:
    title: 'Garage'
    icon: 'mdi:shuffle-variant'
    url: 'http://192.168.0.99'

http:
  api_password: !secret home_password
  base_url: !secret home_url
  ssl_certificate: /ssl/fullchain.pem
  ssl_key: /ssl/privkey.pem

# Checks for available updates
updater:

# Discover some devices automatically
discovery:

# Allows you to issue voice commands from the frontend in enabled browsers
conversation:

# Enables support for tracking state changes over time.
history:
  use_include_order: True
  include:
    domains:
      - sensor
      - climate
      - switch
      - media_player
  exclude:
    domains:
      - automation
      - weblink
      - updater

# View all events in a logbook
logbook:
  include:
    domains:
      - sensor
      - switch
      - media_player
      - cover
      - light
  exclude:
    domains:
      - automation
    entities:
      - automation.sonoff_http_command

# Track the sun
sun:

# Weather Prediction
sensor: !include_dir_merge_list sensor/

binary_sensor: !include_dir_merge_list binary_sensor/

# Text to speech
tts:
  platform: google
  language: 'it'

#MQTT
mqtt:
  broker: !secret mqtt_broker
  port: !secret mqtt_port
  client_id: home-assistant-1
  keepalive: 60
  username: !secret mqtt_username
  password: !secret mqtt_password
  protocol: 3.1
  discovery: true
  discovery_prefix: homeassistant
  birth_message:
    topic: "tele/hass1/LWT"
    payload: "Online"
    qos: 1
    retain: true
  will_message:
    topic: "tele/hass1/LWT"
    payload: "Offline"
    qos: 1
    retain: true

# Lights
light: !include_dir_merge_list lights/
hue:
  bridges:
    - host: !secret hue_host
      allow_hue_groups: true

# Netatmo entry
netatmo:
  api_key: !secret netatmo_api_key
  secret_key: !secret netatmo_secret_key
  username: !secret netatmo_username
  password: !secret netatmo_password

# APC
apcupsd:
  host: localhost

# Presence detector
device_tracker:
  - platform: nmap_tracker
    hosts: 
      - 192.168.0.60
      - 192.168.0.62
    consider_home: 50
    track_new_devices: true
  - platform: ping
    hosts:
      hostone: 192.168.0.62

homekit:
  pincode: '123-45-678'
  port: 51827

# Media Player
media_player: !include_dir_merge_list media_player/

# Groups
group: !include_dir_merge_named group

# Zone
zone 2:
  name: Lavoro
  latitude: !secret work_latitude
  longitude: !secret work_longitude
  radius: 50
  icon: mdi:worker

# Xiaomi Aqara
xiaomi_aqara:
  discovery_retry: 5
  gateways:
    - key: !secret xiaomi_key

# Confiuration Panel
config:

# iOS Component
ios:
  push:
    categories:
      - name: garage1
        identifier: 'garage'
        actions:
          - identifier: 'CHIUDI_GARAGE' ## this must point to an action ##
            title: 'Chiudi saracinesca'
            activationMode: 'background'
            authenticationRequired: yes
            destructive: yes
            behavior: 'default'

#IFTT Component
ifttt:
  key: !secret ifttt_key

# Automations
automation: !include automations.yaml

# Automation Old
automation old:
  - alias: Notify iLendrius Garage #creates the notification
    initial_state: True
    hide_entity: True
    trigger:
    - entity_id: binary_sensor.door_window_sensor_158d0001fd6296
      from: 'off'
      platform: state
      to: 'on'
    action:
        service: notify.ios_ilendrius #id of your ios device, might not show up until you've loaded the ios component in HA
        data:
          title: "Garage" #customizable
          message: "La saracinesca Ã¨ aperta" #customizable 
          data:
            push:
              badge: 0 # this will remove the badge/app icon number
              category: 'garage' #name matched in ios component

  - alias: iOS app notification action garage1 #creates the action button
    initial_state: True
    hide_entity: True  
    trigger:
      platform: event
      event_type: ios.notification_action_fired
      event_data:
        actionName: CHIUDI_GARAGE #name matched in ios component
    action:
      service: switch.turn_on
      entity_id: switch.sonoff_garage_4

# Alarm
alarm_control_panel: !include alarm.yaml
panel_custom: !include panel_custom.yaml

# Script
script: !include_dir_merge_named script

# Input Select
input_select: !include_dir_merge_named input_select

# Switch
switch: !include_dir_merge_list switch

# Cover
cover: !include_dir_merge_list cover

# Input Number
input_number: !include_dir_merge_named input_number

